---
layout: page
tags: 图论
image: /assets/image/34.jpeg
description: xxxxxxxxxxxxxxxxxx
author: pk
title: 拓扑排序（Topo Sort）
categories: [计算机, 数据结构与算法]
---

# 拓扑排序

在保持依赖关系的前提下，将节点排成一行，也可以看作是图的一种搜索方式。

虽然 DFS（后序遍历 + 反转）、BFS 都可以实现拓扑排序，但实现都不如 kahn 算法优雅，且适用性更广。

# Kahn 算法

从入度为 0 的节点开始遍历，期间减少相邻节点的入度，并在入度减少为 0 时加入队列 ...... 不断重复
```cpp
vector<int> topo_sort(vector<vector<int>>& g) {
    int n = g.size();

    //统计入度
    vector<int> indeg(n);
    for(auto &vs : g) {
        for(int v : vs) {
            ++indeg[v];
        }
    }

    //保存入度为 0 的顶点
    queue<int> que;
    for(int i = 0; i < n; ++i) {
        if(indeg[i] == 0) que.push(i);
    }

    vector<int> topo;
    while(!que.empty()) {
        int u = que.front();
        que.pop();
        topo.push_back(u);
        for(int v : g[u]) {
            if(--indeg[v] == 0) {
                que.push(v);
            }
        }
    }
    return topo;
}
```

复杂度：
- 时间：$O(E)$
- 空间：$O(V)$

思考 1：拓扑排序结果中未出现的顶点构成环（一个或多个环）
- 多个环如何分开？并查集？
- 当两个环共边时，这种情况没法分开吧？

思考 2：无向图如何拓扑排序，度为 1 的节点，都是叶子节点，可以仿照拓扑排序卡恩算法，从外到内遍历节点


# 最长路问题

拓扑排序最长路：按照拓扑序进行搜索，结合动态规划，求解处最长路。

之所以必须按照拓扑序列进行搜索，是保证动态规划的正确性的前提。

---


有向无环图（不带权，起点任意），有向无环图（带权，起点任意），有向无环图（带权，起点固定）

有向无环图：
- 带权：权重可正可负可为零；
- 起点任意：指的是起点可以为任意入度为 0 的节点之一；

有向无环图：

- 带权：权重可正可负可为零；
- 起点固定：指的是起点为入度为 0 的节点之一。

