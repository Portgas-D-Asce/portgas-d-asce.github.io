# 概述

每个表达式都有一个**类型（type）**，该类型描述其计算产生的值的静态类型



每个表达式还有一个**值类别（value categories）**，该类别描述了值是如何形成的，以及如何影响表达式的行为



# 移动语义

**很多时候，对象拷贝后就立即被销毁了：** 使用移动语义可以提升效率



**有些对象不能被拷贝，但可以被移动：** 例如 IO 类，unique_ptr 类，包含了不能被共享的资源



为了支持移动语义，C++11 引入了右值引用



# C++11 值类别

```bash
      expression
      /        \
    glvalue   rvalue
    /     \   /    \
lvalue   xvalue   prvalue
```



C++ 表达式类别有五种：glvalue、rvalue、lvalue、xvalue、prvalue，后三者是基本类型。



表达式有两个属性：

- **有身份(has identity)：** 能够确定某个表达式是否和另一个表达式指涉(refers to) 同一个实体。可以理解为可以取地址的表达式
- **能被移动(can be moved from)：** 能够被移动构造函数、移动赋值运算符或者其他实现移动语义的重载函数绑定。



根据上面两个属性，可以对表达式进行分类：

- 有身份但是不能被移动的表达式称为 **左值表达式 lvalue expression**
- 没有身份但是能被移动的表达式称为 **纯右值表达式 prvalue expression**
- 既有身份又能被移动的表达式称为 **xvalue 表达式 xvalue expression**
- 不存在既没有身份又不能被移动的表达式。



可以使用 `decltype((x))` 来判断 `x` 的型别。



## lvalue

有身份，但不能被移动的表达式，常见的有：

- 常见的变量，变量的引用等。
- 返回引用类型的函数/操作符的返回结果等



## prvalue

没身份，但是可以被移动的表达式，常见的有：

- 字面量常量：5，'x' 等
- 返回值类型的函数/操作符等



## xvalue

有身份，也可以被移动的表达式，常见的有：

- move(x) 等





# 左值引用

左值引用只能接收 lvalue



const 左值引用可以接收 lvalue、xvalue、prvalue



# 右值引用

右值引用只能接受 prvalue、xvalue 



