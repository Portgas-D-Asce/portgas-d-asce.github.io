---
layout: page
tags: 数据结构与算法 数论
image: /assets/image/12.jpeg
description: xxxxxxxxxxxxxxxxxx
author: pk
title: 摩尔投票法
---

# 摩尔投票法

Boyer–Moore majority vote algorithm

- 可以在常数空间复杂度找出多数元素
- 恰好一半不能算作是多数元素
- 主要元素不一定存在，投票完成之后需要进行检验



```cpp
int moore_vote(const vector<int> &nums) {
    int maj = -1, cnt = 0;
    for(int num : nums) {
        if(cnt == 0) {
            maj = num;
            cnt = 1;
        } else if(num != maj) {
            cnt--;
        } else {
            cnt++;
        }
    }
    
    cnt = 0;
    for(int num : nums) {
        cnt += maj == num;
    }
    return (cnt << 1) > nums.size() ? maj : -1;
}
```



# 封装



返回迭代器的好处：

- 就函数目标来说，返回迭代器与返回值都是可以的
- 当没有多数元素时，返回哪个数合适呢？
    - 返回值：返回哪个数都不合适！！
    - 返回迭代器：用 last 表示没有找到的情况，岂不完美

```cpp
template<typename FIterator>
FIterator moore_vote(FIterator first, FIterator last) {
    ssize_t cnt = 0;
    FIterator maj = last;
    for(FIterator cur = first; cur != last; ++cur) {
        if(cnt == 0) {
            maj = cur;
            cnt = 1;
        } else if(*cur != *maj) {
            --cnt;
        } else {
            ++cnt;
        }
    }
    
    cnt = 0;
    ssize_t total = 0;
    for(FIterator cur = first; cur != last; ++cur) {
        ++total;
        if(*cur == *maj) {
            ++cnt;
        }
    }
    return (cnt << 1) > total ? maj : last;
}
```



# 练习

[LeetCode 169. 多数元素](https://leetcode.cn/problems/majority-element/)

[LeetCode 面试题 17.10. 主要元素](https://leetcode.cn/problems/find-majority-element-lcci/)

[LeetCode 229. 多数元素 II](https://leetcode.cn/problems/majority-element-ii/)

[CodeForces 913 C. Removal of Unattractive Pairs](https://codeforces.com/contest/1907/problem/C)