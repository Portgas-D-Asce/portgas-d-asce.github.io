---
layout: page
tags: 数论
image: /assets/image/17.jpeg
description: xxxxxxxxxxxxxxxxxx
author: pk
title: 质因数分解
categories: [计算机, 数据结构与算法]
---

# 原理

先对素数进行打表，然后逐个尝试素数：

- 如果不能整除，说明该素数不是素因子
- 如果可以整除，则说明是素因子，循环消除所有该素因子



消除素因子的过程，会使得 $x$ 逐渐变小，遍历至 $prime * prime > x$ 即可退出

- 当退出时 $x == 1$，说明素因子已消除完了
- 当退出时 $x != 1$，则 $x$ 也为一个素因子



# 实现

质数已打表

```cpp
vector<int> factorization(const vector<int> &primes, int x) {
    vector<int> factors;
    for(int i = 0; primes[i] * primes[i] <= x; ++i) {
        while(x % prime == 0) {
            factors.push_back(prime);
            x /= prime;
        }
    }
    if(x != 1) {
        factors.push_back(x);
    }
    return factors;
}
```

质数未打表

```cpp
vector<int> factorize(int x) {
    vector<int> factors;
    while(x & 1 == 0) {
        factors.push_back(2);
        x >>= 1;
    }
    for(int i = 3; i * i <= x; i += 2) {
        while(x % i == 0) {
            factors.push_back(i);
            x /= i;
        }
    }
    if(x != 1) {
        factors.push_back(x);
    }
    return factors;
}
```



# 复杂度

时间复杂度：$O(sqrt(n))$

空间复杂度：$O(sqrt(n))$

